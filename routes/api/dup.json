{"duplicates":[{"lines":25,"tokens":176,"firstFile":{"start":77,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboard.html"},"secondFile":{"start":27,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileView.html"},"fragment":"                    &lt;div ng-if=&quot;vm.files&quot;&gt;\r\n                        &lt;div style=&quot;display: block&quot;&gt;\r\n                            &lt;div class=&quot;legend-label&quot;&gt;&lt;label&gt;Legend&lt;/label&gt;&lt;/div&gt;\r\n                            &lt;div&gt;&lt;span class=&quot;hot-label&quot;&gt;Hot&lt;/span&gt;&lt;/div&gt;\r\n                            &lt;div&gt;&lt;span class=&quot;cold-label&quot;&gt;Cold&lt;/span&gt;&lt;/div&gt;\r\n                            &lt;div class=&quot;color-legend&quot;&gt;&lt;/div&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;br&gt;\r\n                        &lt;label class=&quot;control-label&quot;&gt;File System:&lt;/label&gt;\r\n                        &lt;div tree-view=&quot;structure&quot; tree-view-options=&quot;options&quot; tree-index=&quot;vm.index&quot;&gt;&lt;/div&gt;\r\n                        &lt;div ng-if=&quot;vm.selectedFile &amp;&amp; !vm.loading&quot; class=&quot;file-details&quot;&gt;\r\n                            &lt;h1&gt;{{vm.selectedFile.name}}&lt;/h1&gt;\r\n                            &lt;ul&gt;\r\n                                &lt;li&gt;{{ ((1 - vm.selectedFile.score[vm.index].Score) * 100).toFixed(1) }}% Likelihood of Containing\r\n                                    Bugs\r\n                                &lt;/li&gt;\r\n                                &lt;li&gt;Last Touched By: {{ vm.selectedFile.last_touched_by }}&lt;/li&gt;\r\n                                &lt;li&gt;&lt;p ng-bind=&quot;vm.selectedFile.last_updated | date:&#x27;EEE MMM dd, yyyy - h:mma&#x27;&quot;&gt;&lt;/p&gt;&lt;/li&gt;\r\n                            &lt;/ul&gt;\r\n                            &lt;button class=&quot;btn btn-primary pull-right&quot; ng-click=&#x27;vm.fileGraph(vm.selectedFile)&#x27; onclick=&#x27;setTimeout(\r\n                            function() { window.dispatchEvent(new Event(&quot;resize&quot;));console.log(&quot;resize&quot;); }, 1000)&#x27;\r\n                            data-toggle=&quot;modal&quot; data-target=&quot;#graphModal&quot;&gt;Graph\r\n                        &lt;/button&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            &lt;!-- Modal --&gt;\r"},{"lines":26,"tokens":153,"firstFile":{"start":99,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboard.html"},"secondFile":{"start":50,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileView.html"},"fragment":"                        &lt;/button&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            &lt;!-- Modal --&gt;\r\n                &lt;div ng-if=&quot;vm.graph == true&quot; id=&quot;graphModal&quot; class=&quot;modal fade&quot; role=&quot;dialog&quot;&gt;\r\n                    &lt;div class=&quot;modal-dialog&quot;&gt;\r\n                        &lt;!-- Modal content--&gt;\r\n                        &lt;div class=&quot;modal-content&quot;&gt;\r\n                            &lt;div class=&quot;modal-header&quot;&gt;\r\n                                &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot;&gt;&amp;times;&lt;/button&gt;\r\n                                &lt;h4 class=&quot;modal-title&quot;&gt;Hotspot Score versus Time&lt;/h4&gt;\r\n                            &lt;/div&gt;\r\n                            &lt;div class=&quot;modal-body&quot;&gt;\r\n                                &lt;div class=&quot;legend-and-body&quot;&gt;\r\n                                    &lt;div class=&quot;legend-bar&quot;&gt;&lt;/div&gt;\r\n                                    &lt;div class=&quot;graph-body&quot;&gt;\r\n                                        &lt;nvd3 options=&quot;vm.graph_options&quot; data=&quot;vm.graph_data&quot;&gt;&lt;/nvd3&gt;\r\n                                    &lt;/div&gt;\r\n                                &lt;/div&gt;\r\n                            &lt;/div&gt;\r\n                            &lt;div class=&quot;modal-footer&quot;&gt;\r\n                                &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot; data-dismiss=&quot;modal&quot;&gt;Close&lt;/button&gt;\r\n                            &lt;/div&gt;\r\n                        &lt;/div&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            &lt;/div&gt;\r"},{"lines":18,"tokens":82,"firstFile":{"start":164,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboardCtrl.js"},"secondFile":{"start":63,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileViewCtrl.js"},"fragment":"                vm.index = response.data.files[0].score.length - 1;\r\n                $scope.structure = response.data;\r\n\r\n                console.log(vm.index);\r\n\r\n                $scope.options = {\r\n\r\n                    onFileSelect: function(file, breadcrums) {\r\n                        $scope.breadcrums = breadcrums;\r\n                        vm.selectedFile = file;\r\n                    }\r\n                };\r\n                vm.files = true;\r\n                vm.loading = false;\r\n            });\r\n\r\n        }\r\n\r\n        function clearView(){\r"},{"lines":12,"tokens":81,"firstFile":{"start":101,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboardCtrl.js"},"secondFile":{"start":143,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileViewCtrl.js"},"fragment":"            });\r\n        }\r\n\r\n        function scoreRepo(repoUrl, snapshots) {\r\n            vm.loading = true;\r\n            $http.get(&#x27;/api/repo/score/&#x27;+ encodeURIComponent(repoUrl) + &#x27;/&#x27; +  encodeURIComponent(snapshots)).then( function (response){\r\n                console.log(response.data);\r\n                vm.loading = false;\r\n                vm.selected.Status.score = true;\r\n                vm.selected.Options.Score = &quot;Rescore&quot;;\r\n            });\r\n        }\r\n\r"},{"lines":111,"tokens":644,"firstFile":{"start":191,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboardCtrl.js"},"secondFile":{"start":171,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileViewCtrl.js"},"fragment":"        function fileGraph(data) {\r\n            vm.graph = true;\r\n\r\n            var repo_start;\r\n            if (data.score.length &gt; 1) repo_start = data.score[0].Time - (data.score[1].Time - data.score[0].Time); //first commit\r\n            else repo_start = data.commits[data.commits.length-1].TimeMs; //first commit on file\r\n            console.log(repo_start);\r\n\r\n            vm.graph_options = {\r\n            chart: {\r\n                type: &#x27;multiChart&#x27;,\r\n                height: 400,\r\n                margin : {\r\n                    top: 20,\r\n                    right: 65,\r\n                    bottom: 75,\r\n                    left: 65\r\n                },\r\n                useInteractiveGuideline: true,\r\n                dispatch: {\r\n                    stateChange: function(e){ console.log(&quot;stateChange&quot;); },\r\n                    changeState: function(e){ console.log(&quot;changeState&quot;); },\r\n                    tooltipShow: function(e){ console.log(&quot;tooltipShow&quot;); },\r\n                    tooltipHide: function(e){ console.log(&quot;tooltipHide&quot;); }\r\n                },\r\n                lines1 : {\r\n                    x : function (d) { return d.x; },\r\n                    y : function (d) { return d.y; },\r\n                    forceY: [0,1],\r\n                    forceX: [repo_start]\r\n                },\r\n\r\n                xAxis: {\r\n                    axisLabel: &#x27;Time&#x27;,\r\n                    tickFormat: function(d){\r\n                        return d3.time.format(&#x27;%x&#x27;)(new Date(d));\r\n                    },\r\n                    rotateLabels: 30\r\n                },\r\n                yAxis1: {\r\n                    axisLabel: &#x27;Score (Cold to Hot)&#x27;,\r\n                    tickFormat: function(d){\r\n                        return d3.format(&#x27;.2f&#x27;)(d);\r\n                    }\r\n                },\r\n                duration : 0,\r\n               \r\n                callback: function(chart){\r\n                    console.log(&quot;!!! lineChart callback !!!&quot;);\r\n                }\r\n            },\r\n            title: {\r\n                enable: true,\r\n                text: data.name + &#x27; lifetime&#x27;\r\n            },\r\n            &quot;styles&quot;: {\r\n                &quot;classes&quot;: {\r\n                  &quot;with-3d-shadow&quot;: false,\r\n                  &quot;nv-line&quot;: false,\r\n                  &quot;gallery&quot;: false\r\n                },\r\n                &quot;css&quot;: {}\r\n              }\r\n            };\r\n\r\n            console.log(data);\r\n\r\n            var points = [];\r\n            var commits = [];\r\n            var bcommits = [];\r\n\r\n            for (var i = 0; i &lt; data.score.length; i++) {\r\n                points.push({x: data.score[i].Time, y: 1-data.score[i].Score});\r\n            }\r\n            for (var j = 0; j &lt; data.commits.length; j++) {\r\n                if (data.commits[j].BugFix)\r\n                    bcommits.push({x: data.commits[j].TimeMs, y: 1});\r\n                else\r\n                    commits.push({x: data.commits[j].TimeMs, y: 1});\r\n            }\r\n            var graph = [];\r\n            if (points.length &gt; 0) {\r\n                graph.push({\r\n                    yAxis : 1,\r\n                    type : &#x27;line&#x27;,\r\n                    values : points,\r\n                    key : data.name,\r\n                    color : &#x27;black&#x27;\r\n                });\r\n            }\r\n            if (commits.length &gt; 0) {\r\n                graph.push({\r\n                    yAxis : 1,\r\n                    type : &#x27;line&#x27;,\r\n                    values : commits,\r\n                    key : &#x27;Commits&#x27;,\r\n                    color : &quot;blue&quot;\r\n                });\r\n            }\r\n            if (bcommits.length &gt; 0) {\r\n                graph.push({\r\n                    yAxis : 1,\r\n                    type : &#x27;line&#x27;,\r\n                    values : bcommits,\r\n                    key : &#x27;Fix Commits&#x27;,\r\n                    color : &quot;red&quot;\r\n                });\r\n            }\r\n            vm.graph_data = graph;\r\n\r\n        }\r\n\r"},{"lines":24,"tokens":130,"firstFile":{"start":35,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboardCtrlSpec.js"},"secondFile":{"start":35,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileViewCtrlSpec.js"},"fragment":"                $httpBackend.expectGET(&#x27;/api/repo&#x27;).respond({success: &#x27;202&#x27;});\r\n                ctrl.init();\r\n\r\n                $httpBackend.flush();\r\n            });\r\n        });\r\n\r\n        describe(&#x27;listRepos&#x27;, function() {\r\n            var expectedResponse = [{id: 12345, url: &quot;https://github.com/myuser/myrepo.git&quot;}];\r\n\r\n            it(&#x27;should return a list of repos &#x27;, function() {\r\n                $httpBackend.expectGET(&#x27;/api/repo&#x27;).respond(expectedResponse);\r\n\r\n                ctrl.listRepos();\r\n\r\n                $httpBackend.flush();\r\n\r\n                expect(ctrl.repos.length).toEqual(1);\r\n                expect((angular.equals(ctrl.repos[0], expectedResponse)));\r\n            });\r\n        });\r\n\r\n        describe(&#x27;addRepository&#x27;, function() {\r\n            var givenURL = &#x27;https://github.com/myuser/myrepo.git&#x27;;\r\n            var initialResponse = [];\r"},{"lines":21,"tokens":116,"firstFile":{"start":76,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileView.html"},"secondFile":{"start":17,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/repository/repository.html"},"fragment":"        &lt;div class=&quot;col-sm-6 col-sm-offset-3&quot;&gt;\r\n            &lt;div ng-if=&quot;vm.reposelected == true &amp;&amp; vm.loading == false&quot;&gt;\r\n                &lt;label class=&quot;control-label&quot;&gt;Repository:&lt;/label&gt;\r\n                &lt;div class=&quot;clearfix&quot;&gt;{{vm.selected.URL}}\r\n                    &lt;form name=&quot;snapshots&quot;&gt;\r\n                        &lt;div class=&quot;form-group&quot;&gt;\r\n                            &lt;label class=&quot;control-label&quot; for=&quot;snapshot&quot;&gt;Snapshots:&lt;/label&gt;\r\n                            &lt;input type=&quot;text&quot;\r\n                                   ng-model=&quot;vm.snapshot&quot; required\r\n                                   pattern=&quot;\\d+&quot;\r\n                                   id=&quot;snapshot&quot;\r\n                                   class=&quot;form-control&quot;\r\n                                   placeholder=&quot;100&quot;/&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;label&gt;Default:\r\n                            &lt;input type=&quot;checkbox&quot; ng-model=&quot;vm.default&quot;&gt;\r\n                        &lt;/label&gt;&lt;br/&gt;\r\n                        &lt;label&gt;Commit Size:\r\n                            &lt;input type=&quot;checkbox&quot; ng-model=&quot;vm.commit_size&quot;&gt;\r\n                        &lt;/label&gt;&lt;br/&gt;\r\n                        &lt;button ng-disabled=&quot;snapshots.$invalid || !vm.selected.Status.scan&quot;\r\n                                ng-click=&#x27;vm.scoreRepo(vm.selected.URL, vm.snapshot)&#x27; class=&quot;btn btn-primary pull-left&quot;&gt;\r"},{"lines":14,"tokens":73,"firstFile":{"start":126,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/fileView/fileViewCtrl.js"},"secondFile":{"start":63,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/repository/repositoryCtrl.js"},"fragment":"            console.log(status);\r\n\r\n        }\r\n        \r\n        function scanRepo(repoUrl) {\r\n            vm.loading = true;\r\n            $http.get(&#x27;/api/repo/scan/&#x27; + encodeURIComponent(repoUrl)).then( function (response){\r\n                console.log(response.data);\r\n                vm.loading = false;\r\n                vm.selected.Status.scan = true;\r\n                vm.selected.Options.Scan = &quot;Rescan&quot;;\r\n            });\r\n        }\r\n\r\n        function clearRepo() {\r"},{"lines":24,"tokens":165,"firstFile":{"start":99,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/dashboard/dashboardCtrl.js"},"secondFile":{"start":79,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/client/repository/repositoryCtrl.js"},"fragment":"                clearRepo();\r\n                vm.loading = false;\r\n            });\r\n        }\r\n\r\n        function scoreRepo(repoUrl, snapshots) {\r\n            vm.loading = true;\r\n            $http.get(&#x27;/api/repo/score/&#x27;+ encodeURIComponent(repoUrl) + &#x27;/&#x27; +  encodeURIComponent(snapshots)).then( function (response){\r\n                console.log(response.data);\r\n                vm.loading = false;\r\n                vm.selected.Status.score = true;\r\n                vm.selected.Options.Score = &quot;Rescore&quot;;\r\n            });\r\n        }\r\n\r\n        function removeRepo(repoUrl) {\r\n            vm.loading = true;\r\n            $http.delete(&#x27;/api/repo/&#x27;+ encodeURIComponent(repoUrl)).then( function (response){\r\n                var index = lodash.findIndex(vm.repos, {&#x27;URL&#x27;: repoUrl});\r\n                vm.repos.splice(index, 1);\r\n                clearRepo();\r\n                vm.loading = false;\r\n            });\r\n        }\r\n\r"},{"lines":11,"tokens":71,"firstFile":{"start":153,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/server/repository/repoCtrl.js"},"secondFile":{"start":220,"name":"/Users/nune/Desktop/andon-final-2018/AndonProj/routes/api/code/Hotspotter/server/repository/repoCtrl.js"},"fragment":"module.exports.scan = function (req, res) {\r\n\r\n    var repoURL     = req.params.repoUrl\r\n    var repoURLHash = sha1(repoURL)\r\n    var repoPath    = &quot;tempProjects/&quot; + repoURLHash\r\n\r\n  \r\n    repoService.retrieveRepo(repoURL, function (err, repo) {\r\n        if (err) {\r\n            console.log(&quot;ERR: &quot; + err)\r\n            res.json({})\r\n        } else {\r"}],"statistics":{"clones":10,"duplications":286,"files":9,"percentage":"7.74","lines":3693}}